# ZIP Service - система загрузки и архивации файлов

## Текущая реализация

Сервис предоставляет базовый функционал для:
- Создания задач на загрузку файлов
- Добавления URL-ссылок в задачи
- Загрузки файлов по HTTP
- Упаковки скачанных файлов в ZIP-архив
- Возврата архива пользователю

### Основные компоненты:
- HTTP сервер на порту 8080
- Менеджер параллельных загрузок
- Система задач (tasks) с UUID идентификаторами
- Валидация URL и типов файлов

## Что реализовано:

### 1. Базовый API:
- `POST /task/create` - создание новой задачи
- `POST /links/add?task={id}` - добавление ссылок
- `GET /task/status?task={id}` - проверка статуса
- `GET /task/download-archive?task={id}` - загрузка архива

### 2. Параллельная загрузка:
- Используются горутины для одновременной загрузки частей файлов
- Объединение частей после завершения всех загрузок

### 3. Обработка ошибок:
- Логирование проблем при загрузке отдельных файлов
- Возврат частичных результатов при ошибках

## Что не реализовано и будет добавлено:

### 1. Ограничения системы:
- [ ] Лимит в 3 одновременно выполняемых задачи (сейчас нет ограничения)
- [ ] Проверка занятости сервера при создании новой задачи

### 2. Фильтрация файлов:
- [ ] Строгая валидация типов файлов (.pdf, .jpeg/.jpg)
- [ ] Отклонение неподдерживаемых типов файлов

### 3. Улучшения обработки ошибок:
- [ ] Детализированные сообщения о недоступных ресурсах
- [ ] Статусы ошибок для каждого файла в ответе

### 4. Дополнительный функционал:
- [ ] Конфигурация через config-файл (порт, лимиты, разрешенные типы)
- [ ] Настроенный swagger
- [ ] Логгирование

### 5. Оптимизации:
- [ ] Ограничение скорости загрузки
- [ ] Проверка доступности файлов перед загрузкой

## Как запустить

1. Установите Go (версия 1.16+)
2. Клонируйте репозиторий:
```bash
   git clone https://github.com/vldmirr/zipService.git
   cd zipService
```
3. Запустите сервер:
```bash
go run main.go
```

## Пример использования
### 1. Создание новой задачи
```bash
curl -X POST http://localhost:8080/task/create
```
### Пример ответа:

```json
{"task_id":"a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8"}
```
### 2. Добавление ссылки в задачу
```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"link":"https://zhjwpku.com/assets/pdf/AnIntroductionToProgrammingInGo.pdf"}' \
  "http://localhost:8080/links/add?task=a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8"
```
Повторите для нескольких ссылок.

### 3. Проверка статуса задачи
```bash
curl "http://localhost:8080/task/status?task=a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8"
```
### Пример ответа:

```json
{"links_count":3}
```
### 4. Загрузка и архивация файлов
``` bash
curl -o result.zip \
  "http://localhost:8080/task/download-archive?task=a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8"
```
Или с кастомным именем архива:

```bash
curl -o custom_name.zip \
  "http://localhost:8080/task/download-archive?task=a1b2c3d4-e5f6-7890-g1h2-i3j4k5l6m7n8&filename=custom_name"
```
## Архитектурные особенности
### Паттерны:
Используется Worker Pool для параллельных загрузок

Sync.Pool для управления временными файлами

Middleware для обработки запросов

### Ограничения:
Нет внешних зависимостей (БД, Docker и т.д.)

Вся конфигурация через код (будет вынесена в config)

### Производительность:
Пул воркеров настраивается через константы

Буферизация при чтении/записи файлов